(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6547],{92683:function(e,t,s){Promise.resolve().then(s.bind(s,93865))},93865:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var r=s(57437),n=s(2265),l=s(6577);let o=(0,s(13e3).Ue)(e=>({user:null,posts:[],savedPosts:[],setUser:t=>e({user:t}),setPosts:t=>e({posts:t}),setSavedPosts:t=>e({savedPosts:t}),addPost:t=>e(e=>({posts:[...e.posts,t]})),updatePost:(t,s)=>e(e=>({posts:e.posts.map(e=>e._id===t?{...e,...s}:e)})),removePost:t=>e(e=>({posts:e.posts.filter(e=>e._id!==t)}))}));var i=s(30998),a=s(7583),c=s.n(a),u=s(77700);let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("textarea",{className:(0,u.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});d.displayName="Textarea";var f=s(65236),m=s(66648);function x(){return(0,r.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-6xl font-bold text-gray-800 mb-4",children:"404"}),(0,r.jsx)("p",{className:"text-xl text-gray-600 mb-8",children:"User Not Found"}),(0,r.jsx)("p",{className:"text-gray-500 mb-8",children:"The user you are looking for does not exist or has been removed."}),(0,r.jsx)("a",{href:"/",className:"inline-block bg-blue-500 text-white font-semibold py-2 px-4 rounded hover:bg-blue-600",children:"Go Back Home"})]})})}var g=s(49690),p=s(54008),h=s(56360),b=s(73314),v=s(87138);function j(e){let{posts:t}=e;return(0,r.jsxs)("div",{className:"pt-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:t.map(e=>(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsx)(v.default,{href:"/post/".concat(e._id),children:(0,r.jsx)(m.default,{src:e.imageUrl[0],alt:"Post image",height:300,width:300,className:"object-cover border"},e._id)})},e._id))}),(0,r.jsx)("div",{className:"pb-24"})]})}function y(){let{user:e,savedPosts:t}=o(e=>({user:e.user,savedPosts:e.savedPosts}));return(0,n.useEffect)(()=>{},[]),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"pt-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:t.map(e=>(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsx)(v.default,{href:"/post/".concat(e._id),children:(0,r.jsx)(m.default,{src:e.imageUrl[0],alt:"Post image",height:300,width:300,className:"object-cover border"},e._id)})},e._id))}),(0,r.jsx)("div",{className:"pb-24"})]})})}function N(e){var t;let{username:s}=e,{edgestore:a}=(0,b.P)(),u=(0,n.useRef)(null),{data:v,status:N}=(0,i.useSession)(),[w,P]=(0,n.useState)(!1),[S,E]=(0,n.useState)(null),[k,C]=(0,n.useState)(null),[U,R]=(0,n.useState)(!1),[_,F]=(0,n.useState)(!1);console.log(v);let[O,V]=(0,n.useState)({name:"",bio:""}),{user:z,posts:D}=o(e=>({user:e.user,posts:e.posts}));async function T(){if(S){let e=await a.publicFiles.upload({file:S,onProgressChange:e=>{console.log(e)}});console.log(e);let t=await l.Z.post("/api/user/uploadProfile",{url:e.url,userId:null==v?void 0:v.id});t&&(console.log(t),E(null),C(null),R(!1),v.user.image=t.data.url)}}if((0,n.useEffect)(()=>{(async()=>{if(z&&v)try{let e=await l.Z.post("/api/user/checkFollowingStatus",{followUser:z.email,orginalUser:v.user.email});P(e.data.followThatUser)}catch(e){console.error("Failed to check following status",e)}})()},[z,v]),(0,n.useEffect)(()=>{console.log(D)},[D]),(0,n.useEffect)(()=>{z&&V({name:z.name,bio:z.bio})},[z]),console.log(D),!z||!z.email)return(0,r.jsx)(x,{});let Z=(null==v?void 0:null===(t=v.user)||void 0===t?void 0:t.email)===z.email;async function A(){P(e=>!e);try{let e=await l.Z.post("/api/user/followprofile",{followUser:z.email,orginalUser:v.user.email});console.log(e)}catch(e){console.error("Failed to follow/unfollow profile",e),P(e=>!e)}}async function I(){try{console.log("invoked"),F(!1);let e=await l.Z.post("/api/user/updateProfile",{...O,email:z.email});e.data.success?(console.log("Profile updated successfully"),F(!1)):console.error("Profile update failed:",e.data.message)}catch(e){console.error("Failed to update profile",e)}}return console.log(),(0,r.jsxs)("div",{className:"pt-16 px-4 sm:px-6 lg:px-8 xl:px-72",children:[_?(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Edit Profile"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),I()},children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Name"}),(0,r.jsx)("input",{type:"text",value:O.name,onChange:e=>V({...O,name:e.target.value}),className:"border border-gray-300 p-2 rounded w-full"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Bio"}),(0,r.jsx)(d,{value:O.bio,onChange:e=>V({...O,bio:e.target.value}),rows:"4"})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{type:"submit",className:" py-1 px-4 rounded",children:(0,r.jsx)("h4",{className:"scroll-m-20 text-xl font-semibold tracking-tight",children:"Save"})}),(0,r.jsx)("button",{type:"button",onClick:()=>F(!1),className:"border border-gray-400 py-1 px-4 rounded",children:(0,r.jsx)("h4",{className:"scroll-m-20 text-xl font-semibold tracking-tight",children:"Cancel"})})]})]})]}):(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:space-x-24",children:[(0,r.jsx)("div",{className:"rounded-full flex items-center justify-center border-gray-300 mb-6 lg:mb-0",children:(0,r.jsx)(m.default,{src:z.profilePicture,className:"rounded-full p-1 w-[145px] h-[145px] object-cover",width:145,height:145,alt:"",onClick:()=>R(!0)})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center lg:flex-row lg:items-start lg:justify-start lg:space-x-6",children:[(0,r.jsxs)("span",{className:"font-bold text-lg",children:["@",z.username]}),(0,r.jsx)("span",{children:Z?(0,r.jsx)("span",{className:"",children:(0,r.jsx)(h.z,{onClick:()=>F(!0),variant:"outline",children:"Edit Profile"})}):(0,r.jsx)("button",{className:"border border-gray-400 rounded py-1 px-2 mt-2 lg:mt-0 hover:bg-gray-200",onClick:A,children:w?"Following":"Follow"})}),(0,r.jsx)("div",{className:"flex items-center justify-center mt-2 lg:mt-0"})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-3 text-center lg:text-left",children:[(0,r.jsxs)("span",{className:"text-sm font-semibold",children:[D.length," posts"]}),(0,r.jsxs)("span",{className:"text-sm font-semibold",children:[z.followers.length," followers"]}),(0,r.jsxs)("span",{className:"text-sm font-semibold",children:[z.following.length," following"]})]}),(0,r.jsxs)("div",{className:"pt-6 grid",children:[(0,r.jsx)("span",{className:"text-lg font-semibold",children:O.name}),(0,r.jsxs)("span",{children:[(0,r.jsx)("br",{}),O.bio]})]})]})]}),(0,r.jsx)("div",{className:"pt-4"}),(0,r.jsx)("div",{className:"border w-full"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)(f.mQ,{defaultValue:"posts",children:[(0,r.jsx)("div",{className:"flex items-center justify-center font-extrabold",children:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)(f.dr,{children:[(0,r.jsx)(f.SP,{value:"posts",children:"Posts"}),(0,r.jsx)(f.SP,{value:"saved-posts",children:"Saved Post"})]})})}),(0,r.jsx)(f.nU,{value:"saved-posts",children:(0,r.jsx)(y,{username:s})}),(0,r.jsx)(f.nU,{value:"posts",children:(0,r.jsx)(j,{posts:D})}),(0,r.jsx)(f.nU,{value:"archived"})]})}),U&&(0,r.jsx)(c(),{isOpen:U,onRequestClose:()=>R(!1),className:"fixed inset-0 flex items-center justify-center p-4",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",ariaHideApp:!1,children:(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg p-6 w-full max-w-lg flex flex-col items-center ",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Profile"}),S?(0,r.jsx)(m.default,{onClick:()=>E(null),src:k,alt:"selected file",width:300,height:300}):(0,r.jsx)(p._HF,{onClick:()=>u.current.click(),className:"text-5xl text-gray-400 cursor-pointer"}),(0,r.jsx)("input",{hidden:!0,ref:u,type:"file",accept:"image/*",onChange:function(e){let t=e.target.files[0];t&&(E(t),C(URL.createObjectURL(t)))}}),(0,r.jsx)("button",{onClick:T,disabled:!S,className:"w-full bg-red-600 text-white p-2 shadow-md rounded-lg hover:brightness-105 disabled:bg-gray-200 disabled:cursor-not-allowed disabled:hover:brightness-100",children:"Upload Profile Picture"}),(0,r.jsx)(g.oHP,{className:"cursor-pointer absolute top-4 right-4 hover:text-red-600 transition duration-300",onClick:function(){R(!1),C(null),E(null)}})]})})]})}var w=s(16463);function P(e){let{children:t}=e,{data:s,status:n}=(0,i.useSession)();return(0,w.useRouter)(),(0,r.jsx)(r.Fragment,{children:t})}function S(e){let{params:t}=e;(0,w.useRouter)();let{user:s,setUser:i,posts:a,setPosts:c,addPost:u,savedPosts:d,setSavedPosts:f}=o(e=>({user:e.user,posts:e.posts,savedPosts:e.savedPosts,setUser:e.setUser,setPosts:e.setPosts,addPost:e.addPost,setSavedPosts:e.setSavedPosts})),{id:m}=t,x=(0,n.useRef)(!1),g=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{(async()=>{if(m&&!x.current)try{x.current=!0;let e=await l.Z.post("/api/user/fetchprofile",{username:m});console.log(e),console.log("Fetched user email:",e.data.user.following),i(e.data.user),c(e.data.post)}catch(e){console.error("Error fetching profile data:",e)}})()},[m,i,c]),(0,n.useEffect)(()=>{(async()=>{if(m&&!g.current)try{g.current=!0;let e=await l.Z.post("/api/user/fetch-saved-posts",{username:m});console.log("Fetched saved posts:",e.data.savedPosts),f(e.data.savedPosts)}catch(e){console.error("Error fetching saved posts:",e)}})()},[m,f]),(0,r.jsx)(P,{children:(0,r.jsx)(N,{})})}s(65449),s(64858)},65449:function(e,t,s){"use strict";s(57437),s(2265)},56360:function(e,t,s){"use strict";s.d(t,{d:function(){return a},z:function(){return c}});var r=s(57437),n=s(2265),l=s(71538),o=s(12218),i=s(77700);let a=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:s,variant:n,size:o,asChild:c=!1,...u}=e,d=c?l.g7:"button";return(0,r.jsx)(d,{className:(0,i.cn)(a({variant:n,size:o,className:s})),ref:t,...u})});c.displayName="Button"},65236:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return a},mQ:function(){return i},nU:function(){return u}});var r=s(57437),n=s(2265),l=s(62447),o=s(77700);let i=l.fC,a=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(l.aV,{ref:t,className:(0,o.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});a.displayName=l.aV.displayName;let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(l.xz,{ref:t,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});c.displayName=l.xz.displayName;let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,o.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});u.displayName=l.VY.displayName},16463:function(e,t,s){"use strict";var r=s(71169);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},34492:function(e,t,s){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(2265),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},l=r.useState,o=r.useEffect,i=r.useLayoutEffect,a=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!n(e,s)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=l({inst:{value:s,getSnapshot:t}}),n=r[0].inst,u=r[1];return i(function(){n.value=s,n.getSnapshot=t,c(n)&&u({inst:n})},[e,s,t]),o(function(){return c(n)&&u({inst:n}),e(function(){c(n)&&u({inst:n})})},[e]),a(s),s};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},85107:function(e,t,s){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(2265),n=s(10554),l="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=n.useSyncExternalStore,i=r.useRef,a=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,s,r,n){var d=i(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;var m=o(e,(d=c(function(){function e(e){if(!a){if(a=!0,o=e,e=r(e),void 0!==n&&f.hasValue){var t=f.value;if(n(t,e))return i=t}return i=e}if(t=i,l(o,e))return t;var s=r(e);return void 0!==n&&n(t,s)?t:(o=e,i=s)}var o,i,a=!1,c=void 0===s?null:s;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,s,r,n]))[0],d[1]);return a(function(){f.hasValue=!0,f.value=m},[m]),u(m),m}},10554:function(e,t,s){"use strict";e.exports=s(34492)},35006:function(e,t,s){"use strict";e.exports=s(85107)},13e3:function(e,t,s){"use strict";s.d(t,{Ue:function(){return d}});var r=s(77902),n=s(2265),l=s(35006);let{useDebugValue:o}=n,{useSyncExternalStoreWithSelector:i}=l,a=!1,c=e=>e,u=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(0,r.M)(e):e,s=(e,s)=>(function(e,t=c,s){s&&!a&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),a=!0);let r=i(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return o(r),r})(t,e,s);return Object.assign(s,t),s},d=e=>e?u(e):u},77902:function(e,t,s){"use strict";s.d(t,{M:function(){return n}});let r=e=>{let t;let s=new Set,r=(e,r)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=r?r:"object"!=typeof n||null===n)?n:Object.assign({},t,n),s.forEach(s=>s(t,e))}},n=()=>t,l={setState:r,getState:n,getInitialState:()=>o,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},o=t=e(r,n,l);return l},n=e=>e?r(e):r}},function(e){e.O(0,[4616,7259,8422,998,6648,8472,7138,4868,7671,556,4143,4784,3118,4858,2971,7023,1744],function(){return e(e.s=92683)}),_N_E=e.O()}]);